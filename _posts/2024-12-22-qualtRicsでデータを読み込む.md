---
layout: post
title: "qualtRicsでデータを読み込む"
date: 2024-12-22 04:28:36 +0900
categories: [r]
tags: [R, qualtRics]
slug: "3"
---

これまでQualtircsで取得したデータを分析するとき、Rで読み込む段階で少し前処理を行っていました。しかし、raw dataは本来加工するべきではありませんし、そもそも一々開いて処理していては面倒極まりないです。

[qualtRics](https://github.com/ropensci/qualtRics)を使うことでこのような前処理をなくすことができるというのを今更ながら知ったので、その方法を自分用にメモしておこうと思います。

ちなみに、私はQualtriqsのAPIキーを取得できないのでデータのエクスポートは自分でやる方法を用いていますが、APIを取得できるのならば直接エクスポートせずにする方法もあるらしいです。

### インストール

`install.packages()`でCRANからインストールします。  
そのままパッケージの読み込みましょう。

```r
install.packages("qualtRics")

library(qualtRics)
```

以下のようにgithubからもインストールできます。

```r
devtools::install_github("ropensci/qualtRics")
```

### データのエクスポート

Qualtriqsの「エクスポートとインポート」から「データをエクスポート」でCSVファイルを数値で指定してダウンロードします。

### データのインポート

続いて、`read_survey()`を用いて読み込みます。  
ここではファイル名を今日の日付（20241222）としています。

```r
dat <- read_survey("20241222.csv")
```

これで終わりです。簡単ですね。

### 感想

完全に無知だった（これまでの方法を疑わなかった）ので、このように前処理を単純化できることに驚きました。おそらく多くの人にとっては当たり前の方法だったと思うので、本当に今更なことを言っているなと思われたことでしょう。それでもこの方法は早めに知れて良かったと思うので、メモに残しておくことにしました。

なお、`read.csv()`とは違って`fileEncoding`に対応していなさそうなので、回答に日本語等の文字が含まれている場合は普通にTSVファイルで出力する方法の方がよさそうです。

また、データのインポートするときに、私は各変数の項目の説明を表示する必要もないかなと思ったので、以下のようにadd_var_labelsの指定もして使用すると思います。

```r
dat <- read_survey("20241222.csv", add_var_labels = FALSE)
```
